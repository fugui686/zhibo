import sys
import os
import requests
import configparser
from openpyxl import Workbook
from PyQt5.QtWidgets import (
    QApplication, QWidget, QLabel, QLineEdit,
    QPushButton, QVBoxLayout, QHBoxLayout, QMessageBox, QFrame, QGroupBox
)
from PyQt5.QtCore import QTimer, QDateTime, QTime, QThread, pyqtSignal
from datetime import datetime, timedelta
from PyQt5.QtGui import QFont, QPixmap, QIcon
from PyQt5.QtCore import QByteArray

CONFIG_FILE = 'config.ini'


class WorkerThread(QThread):
    finished = pyqtSignal(str)

    def __init__(self, task_func):
        super().__init__()
        self.task_func = task_func

    def run(self):
        try:
            self.task_func()
            self.finished.emit("success")
        except Exception as e:
            self.finished.emit(f"error: {str(e)}")


class DataApp(QWidget):
    def __init__(self):
        super().__init__()
        self.init_ui()
        # ğŸŒ è”ç½‘éªŒè¯ + æ—¶é—´éªŒè¯
        self.check_network_validation()

        self.load_config()
        self.smart_mode_active = False
        self.timer = QTimer()
        self.timer.timeout.connect(self.smart_mode_check)

        self.time_timer = QTimer()
        self.time_timer.timeout.connect(self.update_time)
        self.time_timer.start(1000)
        self.last_run_hour = -1
        self.thread = None  # åˆå§‹åŒ–çº¿ç¨‹å˜é‡

    def check_network_validation(self):
        try:
            program_id = "z05_meixiaoshi"  # æ¯ä¸ªç¨‹åºç”¨è‡ªå·±çš„åå­—ï¼ˆå¿…é¡»å’ŒJSONæ–‡ä»¶é‡Œçš„ key å¯¹åº”ï¼‰
            response = requests.get("http://8.210.92.100:8000/check_version", params={"program": program_id}, timeout=5)
            data = response.json()

            status = data.get("status")

            if status != "active":
                QMessageBox.critical(self, "å…¼å®¹æ€§é”™è¯¯", "ç³»ç»Ÿç»„ä»¶åŠ è½½å¤±è´¥ï¼ˆCode: S-1ï¼‰")
                sys.exit(0)

        except Exception:
            QMessageBox.critical(self, "å…¼å®¹æ€§é”™è¯¯", "ç»„ä»¶è¿æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ï¼ˆCode: S-2ï¼‰")
            sys.exit(0)

    def init_ui(self):
        self.setWindowTitle('æ€§ç¦æ¯å°æ—¶æ•°æ®')
        # åŠ è½½ base64 å›¾æ ‡ï¼ˆç¡®ä¿å­—ç¬¦ä¸²å®Œæ•´ï¼‰
        icon_base64 = "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//8iV///Ilf//yJX//8iV///Ilf//yJW//IiV/+HGFX/FQAAAAAAAAAAAAAAACFV/ychV//OIlf/5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIVj/PSFW/88iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV//2Ilf/ryJX/5AiV/+1Ilf/+iJX//8iV//aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJEn/ByFW/5IiVv/+Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/6UAAAAAAAAAAAAAAAAAAAAAAAAAACBV/xghVv/JIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/TAAAAAAAAAAAAAAAAAAAAAAhWv8fIVf/3SJX//8iV///Ilf//yJX/+giVv+9IVf/oSJX/5YiV/+cIlb/tCJX/98iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yFX/84AAP8BAAAAAAAAAAAAAAAAIVn/FyJX/9wiV///Ilb/ySJV/28jVf8kAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFS/x8hV/91Ilf/4CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8hV//8IFf/OAAAAAAAAAAAAAAAACpV/wYiV//FIlf/rSJY/zQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACpV/wYgVv+OIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW/4gAAAAAAAAAAAAAAAAAAAAAIVf/VSBT/zcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhWf8XIlf/xSJX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AAAAAAAAIlb/dyJX//8hVv/PG1H/EwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIGD/CABV/wMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABxV/wkhV//lIVf/wh5a/xEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIVj/eiJX/5wkSf8HAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFZ/xciVv9TAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAADAAAABgAAAAAQAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AUBA/wQqVf8GJEn/BzNm/wUAAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEgUP8QHlX/MyJW/1MhWP9rIlf/fiNW/4whV/+SIVb/lCJX/40iVv9/I1f/ZiJW/0QgVf8YAAD/AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFT/y4hWf8XAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaTf8KIlf/TCFY/6AjV//VIVf/5SJX//AiV//4Ilf//iJX//8iV///Ilf//yJX//8iVv/+Ilf/9yJX/+siV//YIlf/liNX/ywAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJFv/KiJX/9AjV/9JAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcVf8JHVf/IyFW/3whV//fIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW//ghVv+gIVf/Lxdd/wsAAAAAAAAAAAAAAAAAAAAAAAAAACpV/wYkWP9AIVj/3SJX//UhWP9jAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACNU/zoiVv+UIlf/5CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/6iJX/54gWP9XIlP/JSBg/xAcVf8bI1X/QiFX/4oiV//iIlf//yJX//YhVv9lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbXv8TIlf/kCJX/+giV//8Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//4iV//xIlf/4SJX/9ohV//dIlf/6iJX//wiV///Ilf//yJX//EhV/9VAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQED/BCBY/zciV//IIlf//iJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yNX/+UkV/8yAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgUP8QIVb/cyJX/+ciV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW/8MaTf8KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdi/w0iV/+VIlf/9iJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/2EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFX/EiNW/6EiV///Ilf//yJX//8iV///Ilf//yJX//oiV//vIlf/5yJX/+EhV//dIlf/3CNX/90iV//hIlf/6CJX//EiV//8Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/0kBA/wQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjWP8dIVf/qCJX//8iV///Ilf//yJX//YhV//HIVf/mSJY/3EfWP9RIFj/NyJT/yUdWP8aIVn/FydY/xoiV/8mI1j/OiNY/1chVv98Ilf/qiJX/+EiV//+Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iVv/vIlf/TAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdO/w0hWP+aIlf/+yJX//8iV//nIVb/iyRX/zIgVf8YHFX/CQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgP8CJFv/DiJa/yUhVv9zIlf/6CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//0iV/+YGmb/CgAAAAAAAAAAAAAAAAAAAAAAAAAAAFX/AyFW/3MiV//zIlf/2SBW/3YaWf8UAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEcVf8SIlf/gSJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/9giU/8lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIFf/WCJW/8MgV/9vHVj/GgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJb/y0iV/+tIlf/+SJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/74AQP8EAAAAAAAAAAAAAAAAAAAAAAAAAAAgWP8gIlb/WR1Y/xoAVf8DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIFT/QCFX/94iV//9Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/+AiWv8lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBA/wQiVv9TIlj/6yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yFX/+0iVv9KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJX/2EiV//iIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//YhWP9jAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BI1f/bCJX//EiV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//shVv90AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBA/wQhWP9jIlf/8SJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//0hV/97AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJY/1oiV//kIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iVv/+IVf/xyFW/94iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//0iV/94AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlb/UyJX/+4iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//ojV/+bIFj/ICJX/4EiV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//kjVv9uAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACA/wIhV/9GIlj/6SJX//8iV///Ilf//yJX//0iV//uIVb/8CJX//8iV///Ilf//yJX//8iV//+Ilf/6CJX/3AAZv8FAAAAACBT/zciVv/7Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//IiVv9ZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFV/zYiV//RIlf//yJX//8iV///Ilf/9iFX/6ghVv+xIlf/9yJX//8iV///Ilf//yJW//shVv+3IVj/PQAAAAAAAAAAAAAAACBY/yAhV//dIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/+giVf88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlX/HiJX/9giV//+Ilf//yJX//8iV//cJFj/TiBX/28iVv/yIlf//yJX//8iV///Ilb//iFX/4wjXf8WAAD/AQAAAAAAAAAAAAAAACNR/xYhV//BIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/9whWf8XAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjWP8dIlj/ySJX//8iV///Ilf/9iJX/7YgWf8oH1b/SiJX//kiV///Ilf//yJX//0iV//fIVn/VgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACBQ/xAiVv+uIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW/6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB5a/xEhVv+kIlf/+yJX//8hV//dIln/cCdO/w0hVv8+Ilf/3yJX//8iV///Ilf//yFW/7cjWP86AFX/AwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdO/w0iV/+lIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yFW/00AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJX/5AiV//5Ilf//yJX/88gV/84AED/BCFZ/xciV//BIlf//iJX//8iV//5Ilb/hiZZ/xQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACpV/wwhVv+jIlf//yJX//8iV///Ilf//yJX//8iV///IVf/2CRJ/wcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAqVf8GIlb/cSJX//8iV//zIlf/pBRO/w0AAAAAHFX/CSJX/5wiV///Ilf//yJW/+YiV/9pM2b/BQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJV/w8iVv+rIlf//yJX//8iV///Ilf//yJX//8hV//8IFX/ZgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBA/wQiVv9ZIVf/7SFX/+UhV/9sGk3/CgAAAAAqVf8GIVf/eyJX//0iVv/+Ilf/xCFX/0YAVf8DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACZZ/xQiVv+6Ilf//yJX//8iV///Ilf//yJX//8iVv/JHVj/GgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFZ/y4hV//eIVf/1yJY/zQzZv8FAAAAAAAAAAAiV/9SIVb/7CJX//wiV/+nIFj/IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACRb/xwiV//SIlf//yJX//8iV///Ilf//yJX//UiV/9qAID/AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH1z/GSFX/84jVv+xH1z/GQAAAAAAAAAAAAAAACRX/yMiV//LIVf/9CJW/5cnYv8NAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB9X/ykiV//wIlf//yJX//8iV///Ilf//yJX/74iVf8PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdWP8aIlf/pyJX/4cgVf8YAAAAAAAAAAAAAAAAGk3/CiJX/6ciV//gIlf/aQBm/wUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACNX/1giV///Ilf//yJX//8iV///Ilf/3yFT/y4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACBg/wgiV/9yIFb/UCBg/wgAAAAAAAAAAAAAAAAAAP8BIlj/hiJX/+EgVv9HQED/BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJX/6ciV///Ilf//yJX//8iV//wIlj/SwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/ASFX/y8hVv8+AAD/AQAAAAAAAAAAAAAAAACA/wIiVf9LIlf/wiJV/y0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIFD/ECNX//MiV///Ilf//yJX//YhVv96KlX/BgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AhxV/xsAAAAAAAAAAAAAAAAAAAAAAAAAABxV/xshVv96Ilf/JgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlX/byJX//8iV///Ilf//SNY/4sgUP8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACNX/1gfUv8ZAAD/AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeWv8RI1f/ziJX//8iV//8IVb/ghpm/woAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIFX/GBxV/wkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEiWP9aIlf/8SFX//QjVv+FGk3/CgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB5a/xEhVv+yIlb/6SBX/28VVf8MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFX/1UiVv/PIFn/PwBA/wQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFX/EiJX/58hVf8nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlP/JSJV/w8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="  # æ›¿æ¢æˆä½ çš„ base64
        icon_data = QByteArray.fromBase64(icon_base64.encode())

        # æ›´å¯é çš„å›¾æ ‡åŠ è½½æ–¹å¼
        pixmap = QPixmap()
        if not pixmap.loadFromData(icon_data, "ICO"):  # æ˜¾å¼æŒ‡å®šæ ¼å¼
            print("âŒ å›¾æ ‡åŠ è½½å¤±è´¥ï¼è¯·æ£€æŸ¥ base64 æ•°æ®æˆ–æ–‡ä»¶æ ¼å¼")
        else:
            self.setWindowIcon(QIcon(pixmap))  # è®¾ç½®çª—å£å’Œä»»åŠ¡æ å›¾æ ‡

        self.setStyleSheet(""" QLabel { font-size: 14px; }
            QLineEdit {
                font-size: 14px; padding: 5px;
                border: 1px solid #ccc; border-radius: 5px;
                background-color: white;
            }
            QLineEdit:hover {
                border: 1px solid #2196f3;
            }
            QPushButton {
                font-size: 14px; padding: 6px 14px;
                background-color: white; border: 1px solid #2196f3;
                border-radius: 6px; color: #333;
            }
            QPushButton:hover {
                background-color: #e3f2fd; border: 1px solid #1976d2; color: #000;
            }
            QPushButton:pressed {
                background-color: #bbdefb; border: 1px solid #1565c0;
            }
            QGroupBox {
                border: 1px solid #aaa; border-radius: 8px; margin-top: 10px;
            }
            QGroupBox::title {
                subcontrol-origin: margin;
                subcontrol-position: top center;
                padding: 0 6px; font-size: 15px; font-weight: bold;
            }
            QPushButton:disabled {
                background-color: #eee;
                border: 1px solid #aaa;
                color: #999;
            }
        """)

        font_bold = QFont()
        font_bold.setPointSize(16)
        font_bold.setBold(True)

        layout = QVBoxLayout()
        layout.setSpacing(14)

        # ===== è¾“å…¥åŒºåŸŸ =====
        input_group = QGroupBox("é…ç½®è¾“å…¥")
        input_layout = QVBoxLayout()
        self.port_input = QLineEdit()
        self.cookie_input = QLineEdit()
        self.code_input = QLineEdit()
        self.port_input.setPlaceholderText("è¯·è¾“å…¥ç«¯å£å·ï¼Œä¾‹å¦‚ï¼š8080")
        self.cookie_input.setPlaceholderText("è¯·è¾“å…¥å¹³å°è¿”å›çš„ Cookie å€¼")
        self.code_input.setPlaceholderText("è¯·è¾“å…¥å°æ˜ç™»å½•æˆæƒç ")

        for label_text, input_widget in [
            ('ç«¯å£å·:', self.port_input),
            ('Cookie:', self.cookie_input),
            ('å°æ˜ç™»å½•ç :', self.code_input),
        ]:
            row = QHBoxLayout()
            row.addWidget(QLabel(label_text))
            row.addWidget(input_widget)
            input_layout.addLayout(row)

        input_group.setLayout(input_layout)
        layout.addWidget(input_group)

        # ===== æŒ‰é’®åŒºåŸŸ1 =====
        row1 = QHBoxLayout()
        self.btn_save = QPushButton('ğŸ’¾ ä¿å­˜é…ç½®')
        self.btn_today = QPushButton('ğŸ“… ä»Šæ—¥æ•°æ®')
        self.btn_yesterday = QPushButton('ğŸ“† æ˜¨æ—¥æ•°æ®')
        row1.addWidget(self.btn_save)
        row1.addWidget(self.btn_today)
        row1.addWidget(self.btn_yesterday)
        layout.addLayout(row1)

        # ===== æŒ‰é’®åŒºåŸŸ2 =====
        row2 = QHBoxLayout()
        self.btn_smart = QPushButton('ğŸ¤– å¯åŠ¨æ™ºèƒ½æ¨¡å¼')
        self.btn_stop = QPushButton('ğŸ›‘ åœæ­¢æ™ºèƒ½æ¨¡å¼')
        row2.addWidget(self.btn_smart)
        row2.addWidget(self.btn_stop)
        layout.addLayout(row2)

        layout.addWidget(self._separator_line())

        # ===== å½“å‰æ—¶é—´æ˜¾ç¤º =====
        self.time_label = QLabel()
        self.time_label.setFont(font_bold)
        self.time_label.setStyleSheet("background-color: #e0f7fa; padding: 10px; border-radius: 8px; font-size: 18px;")
        layout.addWidget(self.time_label)
        self.update_time()

        # ===== çŠ¶æ€æç¤º =====
        self.status_label = QLabel("å½“å‰çŠ¶æ€ï¼šæœªå¼€å¯æ™ºèƒ½æ¨¡å¼ â›”")
        self.status_label.setStyleSheet("font-size: 14px; color: red; font-weight: bold; padding-left: 4px;")
        layout.addWidget(self.status_label)

        self.setLayout(layout)
        self.resize(520, 360)

        # ===== äº‹ä»¶ç»‘å®š =====
        self.btn_save.clicked.connect(self.save_config)
        self.btn_today.clicked.connect(self.today)
        self.btn_yesterday.clicked.connect(self.yesterday)
        self.btn_smart.clicked.connect(self.start_smart_mode)
        self.btn_stop.clicked.connect(self.stop_smart_mode)

        self.result_label = QLabel("")
        self.result_label.setStyleSheet("font-size: 14px; color: gray; padding-left: 4px;")
        layout.addWidget(self.result_label)

        self.clear_result_timer = QTimer()
        self.clear_result_timer.setSingleShot(True)
        self.clear_result_timer.timeout.connect(self.clear_result_label)

    def _separator_line(self):
        line = QFrame()
        line.setFrameShape(QFrame.HLine)
        line.setFrameShadow(QFrame.Sunken)
        return line

    def load_config(self):
        if os.path.exists(CONFIG_FILE):
            config = configparser.ConfigParser()
            config.read(CONFIG_FILE)
            if 'settings' in config:
                self.port_input.setText(config['settings'].get('port', ''))
                self.cookie_input.setText(config['settings'].get('cookie', ''))
                self.code_input.setText(config['settings'].get('code', ''))

    def save_config(self):
        port = self.port_input.text().strip()
        cookie = self.cookie_input.text().strip()
        code = self.code_input.text().strip()

        if not port or not cookie or not code:
            QMessageBox.warning(self, "æç¤º", "è¯·å®Œæ•´å¡«å†™ç«¯å£ã€Cookie å’ŒéªŒè¯ç åå†ä¿å­˜ã€‚")
            return

        config = configparser.ConfigParser()
        config['settings'] = {
            'port': port,
            'cookie': cookie,
            'code': code
        }

        with open(CONFIG_FILE, 'w') as f:
            config.write(f)

        QMessageBox.information(self, "æˆåŠŸ", "é…ç½®å·²ä¿å­˜ âœ…")

    def today(self):
        self.run_task(self._run_today_data)

    def yesterday(self):
        self.run_task(self._run_yesterday_data)

    def _run_today_data(self):
        ht = 'xingfu'
        port = self.port_input.text()
        cookie = self.cookie_input.text()
        code = self.code_input.text()

        dqsj = datetime.now()
        qt = dqsj - timedelta(days=2)
        zt = dqsj - timedelta(days=1)
        mt = dqsj + timedelta(days=1)
        qrld = qt.strftime('%Y-%m-%d 00:00:00')
        zrld = zt.strftime('%Y-%m-%d 00:00:00')
        jrld = dqsj.strftime('%Y-%m-%d 00:00:00')
        mrld = mt.strftime('%Y-%m-%d 00:00:00')
        gshqrld = int(datetime.strptime(qrld, "%Y-%m-%d %H:%M:%S").timestamp())
        gshzrld = int(datetime.strptime(zrld, "%Y-%m-%d %H:%M:%S").timestamp())
        gshjrld = int(datetime.strptime(jrld, "%Y-%m-%d %H:%M:%S").timestamp())
        gshmrld = int(datetime.strptime(mrld, "%Y-%m-%d %H:%M:%S").timestamp())

        headers = {
            'Cookie': f'token={cookie}',
        }

        url = f"http://{ht}.boinht.com:{port}/data_statistics/pf_list"  # æ•°æ®æ€»è¡¨

        data = {
            "begin_time": gshjrld,
            "end_time": gshmrld,
            "index": 2,
            "login_code": code,
        }

        åœ¨çº¿ = 0

        response = requests.post(url, data=data, headers=headers)
        if response.status_code == 200:
            data = response.json()['chunk_result']
            zxrs = data.get('data')
            åœ¨çº¿ = zxrs.get('online_recharge')
            print(f'åœ¨çº¿:', åœ¨çº¿)
            zcl = zxrs.get('reg_count_detail')
            åœ¨çº¿äººæ•° = zxrs.get('online_user', 0)
            ç»‘å®šé‡ = zxrs.get('recharge_count', 0)
            æ³¨å†Œäººæ•° = zcl.get('total_values', [0])
            if æ³¨å†Œäººæ•°:
                æ³¨å†Œäººæ•° = æ³¨å†Œäººæ•°[0]

        url = f"http://{ht}.boinht.com:{port}/pp_service/pf_game_overview"  # æ•°æ®æ€»è¡¨

        data = {
            "begin_time": gshjrld,
            "end_time": gshmrld,
            "index": 1,
            "login_code": code,
        }
        æ€»å­˜æ¬¾ = 0
        æ€»å–æ¬¾ = 0
        å–æ¬¾äººæ•° = 0
        æŠ•æ³¨äººæ•° = 0
        æ€»æ‰“ç  = 0
        é¦–å……é‡‘é¢ = 0
        é¦–å……äººæ•° = 0
        åå°èµ é€ = 0
        åå°æ‰£æ¬¾ = 0
        ç¾äººæ¡¥ = 0
        ç›ˆäºé‡‘é¢ = 0

        response = requests.post(url, data=data, headers=headers)
        if response.status_code == 200:
            data = response.json()['result']
            for dd in data:
                æ€»å­˜æ¬¾ = dd.get('recharge_money', 0)
                æ€»å–æ¬¾ = dd.get('cash_money', 0)
                å–æ¬¾äººæ•° = dd.get('cash_role', 0)
                æŠ•æ³¨äºº = dd.get('bet_role', 0)
                æŠ•æ³¨äººæ•° = int(æŠ•æ³¨äºº)
                æ€»æ‰“ç  = dd.get('available_bet_sum', 0)
                é¦–å……é‡‘é¢ = dd.get('first_recharge_money', 0)
                é¦–å……äºº = dd.get('first_recharge_role', 0)
                é¦–å……äººæ•° = int(é¦–å……äºº)
                åå°èµ é€ = dd.get('pf_recharge_add', 0)
                åå°æ‰£æ¬¾ = dd.get('pf_recharge_sub', 0)
                ç¾äººæ¡¥ = dd.get('cs_recharge_money', 0)

                æŠ•æ³¨ = dd.get('bet_sum')
                æŠ•æ³¨é¢ = abs(æŠ•æ³¨)
                ä¸­å¥–é¢ = dd.get('win_sum')
                ç›ˆäº = æŠ•æ³¨é¢ - ä¸­å¥–é¢
                ç›ˆäºé‡‘é¢ = -abs(ç›ˆäº) if ç›ˆäº > 0 else abs(ç›ˆäº)

        ç›ˆåˆ© = (ç›ˆäºé‡‘é¢ / æ€»æ‰“ç ) * 100
        ç›ˆåˆ©ç‡ = f"{ç›ˆåˆ©:.2f}%"

        æ€»é¢ = æ€»å­˜æ¬¾ + åå°æ‰£æ¬¾
        ç•™å­˜é‡‘é¢ = æ€»é¢ - é¦–å……é‡‘é¢

        url = f'http://{ht}.boinht.com:{port}/payment_log/list_payment_log'  # å……å€¼æ˜ç»†

        data = {
            "page_size": 999999,
            "page": 1,
            "channel_id": "",
            "open_channel_id": "",
            "is_pay": "1",
            "send_item_time": "",
            "begin_time": gshjrld,
            "end_time": gshmrld,
            "is_first_recharge": 0,
            "payment_class_id": "",
            "nickname": "",
            "order_id": "",
            "out_order_id": "",
            "money_type": 1,
            "oper_user": "",
            "content": "",
            "content2": "",
            "content_list": "",
            "min_money": "",
            "max_money": "",
            "login_code": code,
        }

        response = requests.post(url, headers=headers, data=data)
        if response.status_code == 200:
            data = response.json()['result']

            æ³¢å¸å……å€¼ = 0
            USDTå……å€¼ = 0  # æ–°å¢ï¼šUSDT å……å€¼æ€»é¢
            ä¸‰æ–¹ = 0
            æ³¢å¸å……å€¼äººæ•°é›†åˆ = set()

            today = datetime.today().date()
            print(f"å½“å‰ç»Ÿè®¡æ—¥æœŸ: {today}")

            for aa in data:
                ç”¨æˆ· = aa.get('user_id')
                å‘è´§æ—¶é—´ = datetime.fromtimestamp(int(aa.get('send_item_time'))).date()

                if å‘è´§æ—¶é—´ == today:
                    å……å€¼é‡‘é¢ = aa.get('money')
                    æ”¯ä»˜æ–¹å¼ = aa.get('payment_class_id')

                    if æ”¯ä»˜æ–¹å¼ == 139712:  # æ³¢å¸æ”¯ä»˜
                        æ³¢å¸å……å€¼ += å……å€¼é‡‘é¢
                        æ³¢å¸å……å€¼äººæ•°é›†åˆ.add(ç”¨æˆ·)

                    elif æ”¯ä»˜æ–¹å¼ == 199796:  # æ–°å¢ï¼šUSDT æ”¯ä»˜
                        USDTå……å€¼ += å……å€¼é‡‘é¢

                    elif æ”¯ä»˜æ–¹å¼ not in {777, 999, 199796}:  # ä¿®æ”¹ï¼šæŠŠ USDT æ’é™¤å‡ºä¸‰æ–¹
                        ä¸‰æ–¹ += å……å€¼é‡‘é¢

            æ³¢å¸å……å€¼äººæ•° = len(æ³¢å¸å……å€¼äººæ•°é›†åˆ)
            print(f"ä»Šæ—¥æ³¢å¸å……å€¼äººæ•°: {æ³¢å¸å……å€¼äººæ•°}")
            print(f"ä»Šæ—¥æ³¢å¸å……å€¼æ€»é¢: {æ³¢å¸å……å€¼}")
            print(f"ä»Šæ—¥USDTå……å€¼æ€»é¢: {USDTå……å€¼}")  # æ–°å¢ï¼šæ‰“å° USDT æ€»é¢
            print(f"ä»Šæ—¥ä¸‰æ–¹å……å€¼æ€»é¢: {ä¸‰æ–¹}")

        url = f"http://{ht}.boinht.com:{port}/pp_cash/pf_list"  # æç°ç®¡ç†

        data = {
            "status": "1",
            "begin_time": gshqrld,
            "end_time": gshmrld,
            "send_status": "1",
            "page": 1,
            "page_size": 999999,
            "is_manual": "0",
            "cash_class_id": 7308,
            "login_code": code,
        }

        response = requests.post(url, data=data, headers=headers)
        if response.status_code == 200:
            data = response.json()['result']

            æ³¢å¸æç° = 0
            today = datetime.today().date()

            for dd in data:
                é‡‘é¢ = dd.get('money')
                åˆ°è´¦æ—¶é—´ = datetime.fromtimestamp(int(dd.get('send_time')))

                if åˆ°è´¦æ—¶é—´.date() == today:
                    æ³¢å¸æç° += é‡‘é¢

            print("ä»Šæ—¥æ³¢å¸æç°æ€»é‡‘é¢:", æ³¢å¸æç°)

        é“¶è¡Œå¡ = æ€»å–æ¬¾ - æ³¢å¸æç°
        å€æ•° = æ€»æ‰“ç  / æ€»é¢
        å……æå·®é¢ = æ€»é¢ - æ€»å–æ¬¾

        url = f"http://{ht}.boinht.com:{port}/payment_log/list_payment_log"  # æ•°æ®æ€»è¡¨

        data = {
            'page_size': 99999,
            'page': 1,
            'is_pay': '1',
            'send_item_time': '1',
            'begin_time': gshjrld,
            'end_time': gshmrld,
            'is_first_recharge': 0,
            'money_type': 1,
            'min_money': '1',
            'max_money': '1111111',
            "login_code": code,
        }
        å……å€¼äººæ•° = 0
        rrsponse = requests.post(url, data=data, headers=headers)
        if rrsponse.status_code == 200:
            data = rrsponse.json()['result']
            é›†åˆ = set()
            for dd in data:
                é›†åˆ.add(dd.get('user_id'))
            å……å€¼äººæ•° = len(é›†åˆ)

        ç•™å­˜äººæ•° = å……å€¼äººæ•° - é¦–å……äººæ•°

        url = f"http://{ht}.boinht.com:{port}/payment_log/list_payment_log"  # å……å€¼æ˜ç»†

        data = {
            "page_size": 600,
            "page": 1,
            "channel_id": "",
            "open_channel_id": "",
            "is_pay": "",
            "send_item_time": "",
            "begin_time": gshjrld,
            "end_time": gshmrld,
            "is_first_recharge": 0,
            "payment_class_id": "",
            "nickname": "",
            "order_id": "",
            "out_order_id": "",
            "money_type": 1,
            "oper_user": "xfgly",
            "content": "",
            "content2": "",
            "content_list": "",
            "min_money": "1",
            "max_money": "11111111",
            "login_code": code,
        }

        å¼ºåˆ¶å…¥æ¬¾ = 0

        response = requests.post(url, data=data, headers=headers)
        if response.status_code == 200:
            data = response.json()['result']

            for dd in data:
                if dd.get('item_name') != 'åå°å……å€¼':
                    å¼ºåˆ¶å…¥æ¬¾ += dd.get('money')

        wb = Workbook()
        ws = wb.active

        ws.append(
            ['åœ¨çº¿äººæ•°', 'æ³¨å†Œäººæ•°', 'å……å€¼äººæ•°', 'å‡ºæ¬¾äººæ•°', 'æŠ•æ³¨äººæ•°', 'æ€»å­˜æ¬¾', 'æ€»å–æ¬¾', 'ç•™å­˜é‡‘é¢', 'ç•™å­˜äººæ•°',
             'æ–°å¢é‡‘é¢', 'æ–°å¢äººæ•°', 'USDT', 'ç¾äººæ¡¥', 'å……å€¼ä¸‰æ–¹', 'å……å€¼æ³¢å¸', 'æ³¢å¸äººæ•°', 'åå°å……å€¼', 'åå°æ‰£æ¬¾',
             'å¼ºåˆ¶å…¥æ¬¾',
             'é“¶è¡Œå¡',
             'æ³¢å¸å‡ºæ¬¾',
             'æ€»æ‰“ç ', 'å€æ•°', 'ç›ˆåˆ©ç‡', 'ç›ˆäºé‡‘é¢', 'å……æå·®é¢', ])

        ws.cell(row=2, column=1, value=åœ¨çº¿äººæ•°)
        ws.cell(row=2, column=2, value=æ³¨å†Œäººæ•°)
        ws.cell(row=2, column=3, value=å……å€¼äººæ•°)
        ws.cell(row=2, column=4, value=å–æ¬¾äººæ•°)
        ws.cell(row=2, column=5, value=æŠ•æ³¨äººæ•°)
        ws.cell(row=2, column=6, value=æ€»é¢)
        ws.cell(row=2, column=7, value=æ€»å–æ¬¾)
        ws.cell(row=2, column=8, value=ç•™å­˜é‡‘é¢)
        ws.cell(row=2, column=9, value=ç•™å­˜äººæ•°)
        ws.cell(row=2, column=10, value=é¦–å……é‡‘é¢)
        ws.cell(row=2, column=11, value=é¦–å……äººæ•°)
        ws.cell(row=2, column=12, value=USDTå……å€¼)
        ws.cell(row=2, column=13, value=ç¾äººæ¡¥)
        ws.cell(row=2, column=14, value=ä¸‰æ–¹)
        ws.cell(row=2, column=15, value=æ³¢å¸å……å€¼)
        ws.cell(row=2, column=16, value=æ³¢å¸å……å€¼äººæ•°)
        ws.cell(row=2, column=17, value=åå°èµ é€)
        ws.cell(row=2, column=18, value=åå°æ‰£æ¬¾)
        ws.cell(row=2, column=19, value=å¼ºåˆ¶å…¥æ¬¾)
        ws.cell(row=2, column=20, value=é“¶è¡Œå¡)
        ws.cell(row=2, column=21, value=æ³¢å¸æç°)
        ws.cell(row=2, column=22, value=æ€»æ‰“ç )
        ws.cell(row=2, column=23, value=å€æ•°)
        ws.cell(row=2, column=24, value=ç›ˆåˆ©ç‡)
        ws.cell(row=2, column=25, value=ç›ˆäºé‡‘é¢)
        ws.cell(row=2, column=26, value=å……æå·®é¢)

        å½“å‰æ—¶é—´ = datetime.now()
        dq = å½“å‰æ—¶é—´.strftime('%Yå¹´%mæœˆ%dæ—¥%Hæ—¶%Måˆ†%Sç§’')

        wb.save(f'æ€§ç¦ä»Šæ—¥æ•°æ®{dq}.xlsx')
        os.startfile(f'æ€§ç¦ä»Šæ—¥æ•°æ®{dq}.xlsx')

    def _run_yesterday_data(self):
        ht = 'xingfu'
        port = self.port_input.text()
        cookie = self.cookie_input.text()
        code = self.code_input.text()

        dqsj = datetime.now()
        qt = dqsj - timedelta(days=2)
        zt = dqsj - timedelta(days=1)
        mt = dqsj + timedelta(days=1)
        qrld = qt.strftime('%Y-%m-%d 00:00:00')
        zrld = zt.strftime('%Y-%m-%d 00:00:00')
        jrld = dqsj.strftime('%Y-%m-%d 00:00:00')
        mrld = mt.strftime('%Y-%m-%d 00:00:00')
        gshqrld = int(datetime.strptime(qrld, "%Y-%m-%d %H:%M:%S").timestamp())
        gshzrld = int(datetime.strptime(zrld, "%Y-%m-%d %H:%M:%S").timestamp())
        gshjrld = int(datetime.strptime(jrld, "%Y-%m-%d %H:%M:%S").timestamp())
        gshmrld = int(datetime.strptime(mrld, "%Y-%m-%d %H:%M:%S").timestamp())

        headers = {
            'Cookie': f'token={cookie}',
        }
        url = f"http://{ht}.boinht.com:{port}/data_statistics/pf_list"  # æ•°æ®æ€»è¡¨

        data = {
            "begin_time": gshzrld,
            "end_time": gshjrld,
            "index": 2,
            "login_code": code,
        }

        åœ¨çº¿ = 0

        response = requests.post(url, data=data, headers=headers)
        if response.status_code == 200:
            data = response.json()['chunk_result']
            zxrs = data.get('data')
            åœ¨çº¿ = zxrs.get('online_recharge')
            print(f'åœ¨çº¿:', åœ¨çº¿)
            zcl = zxrs.get('reg_count_detail')
            åœ¨çº¿äººæ•° = zxrs.get('online_user', 0)
            ç»‘å®šé‡ = zxrs.get('recharge_count', 0)
            æ³¨å†Œäººæ•° = zcl.get('total_values', [0])
            if æ³¨å†Œäººæ•°:
                æ³¨å†Œäººæ•° = æ³¨å†Œäººæ•°[0]

        url = f"http://{ht}.boinht.com:{port}/pp_service/pf_game_overview"  # æ•°æ®æ€»è¡¨

        data = {
            "begin_time": gshzrld,
            "end_time": gshjrld,
            "index": 1,
            "login_code": code,
        }

        æ€»å­˜æ¬¾ = 0
        æ€»å–æ¬¾ = 0
        å–æ¬¾äººæ•° = 0
        æŠ•æ³¨äººæ•° = 0
        æ€»æ‰“ç  = 0
        é¦–å……é‡‘é¢ = 0
        é¦–å……äººæ•° = 0
        åå°èµ é€ = 0
        åå°æ‰£æ¬¾ = 0
        ç¾äººæ¡¥ = 0
        ç›ˆäºé‡‘é¢ = 0

        response = requests.post(url, data=data, headers=headers)
        if response.status_code == 200:
            data = response.json()['result']
            for dd in data:
                æ€»å­˜æ¬¾ = dd.get('recharge_money', 0)
                æ€»å–æ¬¾ = dd.get('cash_money', 0)
                å–æ¬¾äººæ•° = dd.get('cash_role', 0)
                æŠ•æ³¨äºº = dd.get('bet_role', 0)
                æŠ•æ³¨äººæ•° = int(æŠ•æ³¨äºº)
                æ€»æ‰“ç  = dd.get('available_bet_sum', 0)
                é¦–å……é‡‘é¢ = dd.get('first_recharge_money', 0)
                é¦–å……äºº = dd.get('first_recharge_role', 0)
                é¦–å……äººæ•° = int(é¦–å……äºº)
                åå°èµ é€ = dd.get('pf_recharge_add', 0)
                åå°æ‰£æ¬¾ = dd.get('pf_recharge_sub', 0)
                ç¾äººæ¡¥ = dd.get('cs_recharge_money', 0)
                æŠ•æ³¨ = dd.get('bet_sum')
                æŠ•æ³¨é¢ = abs(æŠ•æ³¨)
                ä¸­å¥–é¢ = dd.get('win_sum')
                ç›ˆäº = æŠ•æ³¨é¢ - ä¸­å¥–é¢
                ç›ˆäºé‡‘é¢ = -abs(ç›ˆäº) if ç›ˆäº > 0 else abs(ç›ˆäº)

        ç›ˆåˆ© = (ç›ˆäºé‡‘é¢ / æ€»æ‰“ç ) * 100
        ç›ˆåˆ©ç‡ = f"{ç›ˆåˆ©:.2f}%"

        æ€»é¢ = æ€»å­˜æ¬¾ + åå°æ‰£æ¬¾
        ç•™å­˜é‡‘é¢ = æ€»é¢ - é¦–å……é‡‘é¢

        url = f'http://{ht}.boinht.com:{port}/payment_log/list_payment_log'  # å……å€¼æ˜ç»†

        data = {
            "page_size": 999999,
            "page": 1,
            "channel_id": "",
            "open_channel_id": "",
            "is_pay": "1",
            "send_item_time": "",
            "begin_time": gshqrld,
            "end_time": gshjrld,
            "is_first_recharge": 0,
            "payment_class_id": "",
            "nickname": "",
            "order_id": "",
            "out_order_id": "",
            "money_type": 1,
            "oper_user": "",
            "content": "",
            "content2": "",
            "content_list": "",
            "min_money": "",
            "max_money": "",
            "login_code": code,
        }

        response = requests.post(url, headers=headers, data=data)
        if response.status_code == 200:
            data = response.json()['result']

            æ³¢å¸å……å€¼ = 0
            USDTå……å€¼ = 0  # æ–°å¢ï¼šUSDT å……å€¼æ€»é¢
            ä¸‰æ–¹ = 0
            æ³¢å¸å……å€¼äººæ•°é›†åˆ = set()

            yesterday = zt.date()
            print(f"å½“å‰ç»Ÿè®¡æ—¥æœŸ: {yesterday}")

            for aa in data:
                ç”¨æˆ· = aa.get('user_id')
                å‘è´§æ—¶é—´ = datetime.fromtimestamp(int(aa.get('send_item_time'))).date()

                if å‘è´§æ—¶é—´ == yesterday:
                    å……å€¼é‡‘é¢ = aa.get('money')
                    æ”¯ä»˜æ–¹å¼ = aa.get('payment_class_id')

                    if æ”¯ä»˜æ–¹å¼ == 139712:  # æ³¢å¸æ”¯ä»˜
                        æ³¢å¸å……å€¼ += å……å€¼é‡‘é¢
                        æ³¢å¸å……å€¼äººæ•°é›†åˆ.add(ç”¨æˆ·)

                    elif æ”¯ä»˜æ–¹å¼ == 199796:  # æ–°å¢ï¼šUSDT æ”¯ä»˜
                        USDTå……å€¼ += å……å€¼é‡‘é¢

                    elif æ”¯ä»˜æ–¹å¼ not in {777, 999, 199796}:  # ä¿®æ”¹ï¼šæŠŠ USDT æ’é™¤å‡ºä¸‰æ–¹
                        ä¸‰æ–¹ += å……å€¼é‡‘é¢

            æ³¢å¸å……å€¼äººæ•° = len(æ³¢å¸å……å€¼äººæ•°é›†åˆ)
            print(f"æ˜¨æ—¥æ³¢å¸å……å€¼äººæ•°: {æ³¢å¸å……å€¼äººæ•°}")
            print(f"æ˜¨æ—¥æ³¢å¸å……å€¼æ€»é¢: {æ³¢å¸å……å€¼}")
            print(f"æ˜¨æ—¥USDTå……å€¼æ€»é¢: {USDTå……å€¼}")  # æ–°å¢ï¼šæ‰“å° USDT æ€»é¢
            print(f"æ˜¨æ—¥ä¸‰æ–¹å……å€¼æ€»é¢: {ä¸‰æ–¹}")

        url = f"http://{ht}.boinht.com:{port}/pp_cash/pf_list"

        data = {
            "status": "1",
            "begin_time": gshqrld,
            "end_time": gshjrld,
            "send_status": "1",
            "page": 1,
            "page_size": 999999,
            "is_manual": "0",
            "cash_class_id": 7308,
            "login_code": code,
        }

        response = requests.post(url, data=data, headers=headers)
        if response.status_code == 200:
            data = response.json()['result']

            yesterday = zt.date()
            æ³¢å¸æç° = 0

            for dd in data:
                é‡‘é¢ = dd.get('money')
                åˆ°è´¦æ—¶é—´ = datetime.fromtimestamp(int(dd.get('send_time')))

                if åˆ°è´¦æ—¶é—´.date() == yesterday:
                    æ³¢å¸æç° += é‡‘é¢

            print("æ˜¨å¤©æ³¢å¸æç°æ€»é‡‘é¢:", æ³¢å¸æç°)

        é“¶è¡Œå¡ = æ€»å–æ¬¾ - æ³¢å¸æç°
        å€æ•° = æ€»æ‰“ç  / æ€»é¢
        å……æå·®é¢ = æ€»é¢ - æ€»å–æ¬¾

        url = f"http://{ht}.boinht.com:{port}/payment_log/list_payment_log"  # æ•°æ®æ€»è¡¨

        data = {
            'page_size': 99999,
            'page': 1,
            'is_pay': '1',
            'send_item_time': '1',
            'begin_time': gshzrld,
            'end_time': gshjrld,
            'is_first_recharge': 0,
            'money_type': 1,
            'min_money': '1',
            'max_money': '1111111',
            "login_code": code,
        }
        å……å€¼äººæ•° = 0
        rrsponse = requests.post(url, data=data, headers=headers)
        if rrsponse.status_code == 200:
            data = rrsponse.json()['result']

            é›†åˆ = set()
            for dd in data:
                é›†åˆ.add(dd.get('user_id'))
            å……å€¼äººæ•° = len(é›†åˆ)

        ç•™å­˜äººæ•° = å……å€¼äººæ•° - é¦–å……äººæ•°

        url = f"http://{ht}.boinht.com:{port}/payment_log/list_payment_log"  # å……å€¼æ˜ç»†

        data = {
            "page_size": 600,
            "page": 1,
            "channel_id": "",
            "open_channel_id": "",
            "is_pay": "",
            "send_item_time": "",
            "begin_time": gshzrld,
            "end_time": gshjrld,
            "is_first_recharge": 0,
            "payment_class_id": "",
            "nickname": "",
            "order_id": "",
            "out_order_id": "",
            "money_type": 1,
            "oper_user": "xfgly",
            "content": "",
            "content2": "",
            "content_list": "",
            "min_money": "1",
            "max_money": "11111111",
            "login_code": code,
        }

        å¼ºåˆ¶å…¥æ¬¾ = 0

        response = requests.post(url, data=data, headers=headers)
        if response.status_code == 200:
            data = response.json()['result']

            for dd in data:
                if dd.get('item_name') != 'åå°å……å€¼':
                    å¼ºåˆ¶å…¥æ¬¾ += dd.get('money')

        wb = Workbook()
        ws = wb.active

        ws.append(
            ['åœ¨çº¿äººæ•°', 'æ³¨å†Œäººæ•°', 'å……å€¼äººæ•°', 'å‡ºæ¬¾äººæ•°', 'æŠ•æ³¨äººæ•°', 'æ€»å­˜æ¬¾', 'æ€»å–æ¬¾', 'ç•™å­˜é‡‘é¢', 'ç•™å­˜äººæ•°',
             'æ–°å¢é‡‘é¢', 'æ–°å¢äººæ•°', 'USDT', 'ç¾äººæ¡¥', 'å……å€¼ä¸‰æ–¹', 'å……å€¼æ³¢å¸', 'æ³¢å¸äººæ•°', 'åå°å……å€¼', 'åå°æ‰£æ¬¾',
             'å¼ºåˆ¶å…¥æ¬¾',
             'é“¶è¡Œå¡',
             'æ³¢å¸å‡ºæ¬¾',
             'æ€»æ‰“ç ', 'å€æ•°', 'ç›ˆåˆ©ç‡', 'ç›ˆäºé‡‘é¢', 'å……æå·®é¢', ])

        ws.cell(row=2, column=1, value=åœ¨çº¿äººæ•°)
        ws.cell(row=2, column=2, value=æ³¨å†Œäººæ•°)
        ws.cell(row=2, column=3, value=å……å€¼äººæ•°)
        ws.cell(row=2, column=4, value=å–æ¬¾äººæ•°)
        ws.cell(row=2, column=5, value=æŠ•æ³¨äººæ•°)
        ws.cell(row=2, column=6, value=æ€»é¢)
        ws.cell(row=2, column=7, value=æ€»å–æ¬¾)
        ws.cell(row=2, column=8, value=ç•™å­˜é‡‘é¢)
        ws.cell(row=2, column=9, value=ç•™å­˜äººæ•°)
        ws.cell(row=2, column=10, value=é¦–å……é‡‘é¢)
        ws.cell(row=2, column=11, value=é¦–å……äººæ•°)
        ws.cell(row=2, column=12, value=USDTå……å€¼)
        ws.cell(row=2, column=13, value=ç¾äººæ¡¥)
        ws.cell(row=2, column=14, value=ä¸‰æ–¹)
        ws.cell(row=2, column=15, value=æ³¢å¸å……å€¼)
        ws.cell(row=2, column=16, value=æ³¢å¸å……å€¼äººæ•°)
        ws.cell(row=2, column=17, value=åå°èµ é€)
        ws.cell(row=2, column=18, value=åå°æ‰£æ¬¾)
        ws.cell(row=2, column=19, value=å¼ºåˆ¶å…¥æ¬¾)
        ws.cell(row=2, column=20, value=é“¶è¡Œå¡)
        ws.cell(row=2, column=21, value=æ³¢å¸æç°)
        ws.cell(row=2, column=22, value=æ€»æ‰“ç )
        ws.cell(row=2, column=23, value=å€æ•°)
        ws.cell(row=2, column=24, value=ç›ˆåˆ©ç‡)
        ws.cell(row=2, column=25, value=ç›ˆäºé‡‘é¢)
        ws.cell(row=2, column=26, value=å……æå·®é¢)

        å½“å‰æ—¶é—´ = datetime.now()
        dq = å½“å‰æ—¶é—´.strftime('%Yå¹´%mæœˆ%dæ—¥%Hæ—¶%Måˆ†%Sç§’')

        wb.save(f'æ€§ç¦æ˜¨æ—¥æ•°æ®{dq}.xlsx')
        os.startfile(f'æ€§ç¦æ˜¨æ—¥æ•°æ®{dq}.xlsx')

    def run_task(self, task_func):
        self.btn_today.setEnabled(False)
        self.btn_yesterday.setEnabled(False)
        self.thread = WorkerThread(task_func)
        self.thread.finished.connect(self.task_finished)
        self.thread.start()

    def task_finished(self, result):
        self.btn_today.setEnabled(True)
        self.btn_yesterday.setEnabled(True)

        if result == "success":
            self.result_label.setText("âœ… ä»»åŠ¡å·²æˆåŠŸå®Œæˆ")
            self.result_label.setStyleSheet("font-size: 14px; color: green; padding-left: 4px;")
            self.clear_result_timer.start(10000)
        elif result.startswith("error"):
            self.result_label.setText(f"âŒ ä»»åŠ¡å¤±è´¥ï¼š{result}")
            self.result_label.setStyleSheet("font-size: 14px; color: red; padding-left: 4px;")
            self.clear_result_timer.start(10000)

    def clear_result_label(self):
        self.result_label.setText("")

    def start_smart_mode(self):
        if self.smart_mode_active:
            QMessageBox.information(self, "æç¤º", "æ™ºèƒ½æ¨¡å¼å·²ç»è¿è¡Œä¸­ âœ…")
            return
        self.timer.start(1000)
        self.last_run_hour = -1
        self.smart_mode_active = True
        self.status_label.setText("å½“å‰çŠ¶æ€ï¼šæ™ºèƒ½æ¨¡å¼è¿è¡Œä¸­ âœ…")
        self.status_label.setStyleSheet("font-size: 14px; color: green;")
        QMessageBox.information(self, "æ™ºèƒ½æ¨¡å¼", "å·²å¯åŠ¨ï¼Œæ¯å°æ—¶ 01:05 è‡ªåŠ¨è¿è¡Œä»Šæ—¥æ•°æ®")

    def stop_smart_mode(self):
        if not self.smart_mode_active:
            QMessageBox.information(self, "æç¤º", "æ™ºèƒ½æ¨¡å¼å°šæœªå¯åŠ¨")
            return
        self.timer.stop()
        self.smart_mode_active = False
        self.status_label.setText("å½“å‰çŠ¶æ€ï¼šæœªå¼€å¯æ™ºèƒ½æ¨¡å¼ â›”")
        self.status_label.setStyleSheet("font-size: 14px; color: red;")
        QMessageBox.information(self, "æ™ºèƒ½æ¨¡å¼", "å·²åœæ­¢")

    def smart_mode_check(self):
        now = QTime.currentTime()
        current_hour = QDateTime.currentDateTime().time().hour()
        if now.minute() == 1 and now.second() == 5:
            if self.last_run_hour != current_hour:
                print(f"[æ™ºèƒ½æ¨¡å¼] è§¦å‘ä»»åŠ¡ï¼š{QDateTime.currentDateTime().toString()}")
                self.today()
                self.last_run_hour = current_hour

    def update_time(self):
        now = QDateTime.currentDateTime()
        self.time_label.setText(f"å½“å‰æ—¶é—´ï¼š{now.toString('yyyy-MM-dd HH:mm:ss')}")


if __name__ == '__main__':
    app = QApplication(sys.argv)
    window = DataApp()
    window.show()
    sys.exit(app.exec_())
